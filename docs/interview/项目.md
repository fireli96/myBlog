## 所有项目中你印象最深刻的是哪一个？为什么

小鹅花钱小程序，因为这个项目是从别人那接手过来的，代码规范十分不好，维护起来困难。主要体现在以下几个方面：

1. 模块耦合，例如 mixin，埋点和业务功能耦合
2. 代码写法，喜欢在一个函数中堆砌多个功能；组件 css class 嵌套过深；

我在一边写业务需求的同时，一边进行了部分优化，在这过程中学习到了许多东西。

卡号处理 mixin。

强制阅读组件 mixin。在不同分包内部有自己的强制阅读组件（历史原因，想减少主包大小），而强制阅读有一些通用逻辑，例如阅读完毕后抛出一些事件，跳到其他页面。采用了高阶组件思想，利用小程序的抽象节点。

组件 css class 扁平化（BEM）

函数优化，例如原先阅读协议，包括拉协议，拼装协议链接，阅读协议等逻辑，都是写在一个函数中的。

构建方面的优化，例如：框架的 tree-shake、主包依赖分离

## 你在这个项目中遇到的最大的困难是什么，是怎么解决的？

tree-shake。

tree-shake 原理，依赖树，babel 使用， ast 节点。

## 你的项目难点有什么？哪里复杂了

主要是代码模块的一些重构优化，以及构建的优化，例如 tree-shake，主包依赖分离减少主包代码。

## 项目中遇到的不足

全局 css 冗余

## bff saas crm

## 聊聊项目中的一个前端体系结构

技术选型

规范

项目设计

性能

单元测试

部署发布 - CI/CD 、git 分支合并 review 、静态资源

监控埋点

安全问题

## 你觉得你最擅长什么

研究一些新的东西，尝试应用到项目中。

写代码有一点洁癖，会比较考虑命名，函数功能分离等

## 你觉得你有做过推动流程或者改善流程的事件么，举例说明

项目构建方面的优化，tree shake 和 依赖分离

## 项目的迭代流程

业务提需求，需求评审，设计评审，案例评审，开发，冒烟测试，sit 测试，uat 测试，回归测试

周版本和月版本

## 微信小程序原理

![](https://pic.rmb.bdstatic.com/bjh/down/45ecab0368447dae0e6a1d63cb1ceea5.png@wm_2,t_55m+5a625Y+3L+eoi+W6j+mCo+eCueS6iw==,fc_ffffff,ff_U2ltSGVp,sz_15,x_10,y_10)

双线程：逻辑层+渲染层

逻辑层：运行 js 的环境，android 为 v8
渲染层：多个 webview

双线程之间通过微信 native 层进行通信，同时 native 层提供原生能力。

## AST 原理

词法分析：将字符序列转换为单词（Token）序列的过程，即每一个字符都有与之对应的 token，例如：`let a = 1`，那么 let，空格，a，=，1 都是一个 token

语法分析：将词法分析的 token 合并成语法树，例如：语句，表达式等

## 知道哪些设计模式

## 项目

**小程序可回溯**

web 可回溯：

1. dom 快照
2. 初次 dom 快照 + 直接影响页面变化的行为记录（rrweb）
    - dom 变动，基于 mutationObserver
    - 滚动行为
    - 点击、输入行为
    - 等等
3. 用户操作记录 + mock 请求 + 创建统一的环境（fundebug）
    - 点击输入等操作
    - mock 请求
    - 用户环境的创建，例如本地缓存数据

小程序可回溯：

1. 用户操作记录 + mock 请求 + 创建统一的环境
2. 借助编译，劫持每个页面和组件的函数执行
3. setData 劫持，路由记录，原生 api 记录

问题点：

1. 原生 api 改变视图，例如 button 的 open-type，需要借助编译记录这个行为
2. 处于生命周期中的 `setData` 在页面加载时会自动执行，如果记录，那回放时，会执行两次，如何不去记录这类 `setData`。同样借助编译

monorepo 仓库，pnpm workspace，pnpm 优势，为啥使用 pnpm

pnpm 优势：

1. 存在一个 cache 目录，可以通过硬链接到这里的包
2. 所有依赖会被提升到根目录，并通过符号连接链接

**鼎甲迪备管理系统**

重构：

1. 通过配置文件的方式重构菜单权限和路由拦截模块
2. oem 重构
3. chartjs 换 echart

性能优化：

1. 打包优化
2. 代码优化

首屏时间计算：页面组件开始加载时减去 performance.timeOrigin

**小鹅花钱小程序**

1. mixin 优化方案。新组件、公共函数、高阶组件、render prop、hooks
2. 埋点，只实现了事件的拦截
3. tree-shake 和 依赖分离

高阶组件：强制阅读有多个组件，但有一些类似的行为，比如阅读完成后抛出一个事件，跳转什么的

### 项目架构，你主要负责了哪些

## 美团一面

1. 项目 - 埋点是怎么做的
2. 项目 - webpack 性能优化用了哪些方法
3. 编程 - 实现 promiseAll
4. 编程 - 用 setTimeout 实现 setInterval，并能够支持取消
5. 浏览器渲染阻塞如何优化 - 分片渲染
6. 事件循环
7. 清除浮动
8. 两栏布局
9. vue 响应式简单写一个或说一下（最好写一下）（说的，写不太出）
10. 迭代器原理（最好写一下）（说了下生成器写法，并且原理只说了个协程两个字。应该是想问：生成器可创建迭代器，for of 原理，添加 `*[Symbol.iterator]` 属性让对象可迭代）

    协程是一个更微小且可中断的线程。
    每当生成器执行 yield 语句时，生成器的堆栈结构（本地变量、参数、临时值、生成器内部当前的执行位置 etc.）被移出堆栈，然而生成器对象保留对这个堆栈结构的引用（备份），所以稍后调用 .next() 可以重新激活堆栈结构并且继续执行。

    （其他考点：生成器，迭代器实现 async 和 await）

11. 跨域
12. 同源-协议、域名、端口

## tplink 一面

1. vue 父子组件传值
2. vue2 和 vue3 区别 （主要答了组合 api 和其优势，proxy）
3. proxy 和 defineProperty 的区别。（一个代理对象，可以监听到对象新增删除，一个代理属性；都需要递归子对象代理；proxy 功能更丰富可拦截 in ，delete 以前其他一些获取属性的方法；defineProperty 代理数组性能问题，例如删除一个数组，将导致后续元素都触发 set，而 proxy 代理对象没这个问题）
4. 大量使用组合 api 有什么劣势。
5. 其他框架有了解过没。（答了 Svelte， Svelte 的特点，无虚拟 dom，主要靠编译成具体操作 dom 的语句，运行时很小）
6. Svelte 缺点。（答了无虚拟 dom 的缺点，跨平台不行，例如 ssr）
7. es6 新增加了哪些数据结构。（set，map，symbol）
8. 了解什么是隐式转换没。（宽松相等 `==`，会隐式转换，没细问，随便举了个例子）
9. 设计模式。（答了发布订阅，单例，答得一般）
10. http 缓存
11. 近年来浏览器给 cookie 做了许多限制，有什么影响。（答了，httpOnly 和 sameSite 属性可以保护 cookie 被盗取，更安全）
12. 接着上一题， cookie 限制对广告的影响。（不太理解网页广告的原理，具体问了下场景，广告是页面嵌入第三方域名的连接，当你浏览网页时，会携带第三方域名 cookie 去第三方域名接口获取你的信息，如果第三方 cookie 被限制（浏览器会限制）或是 cookie 被设置 sameSite 同源，那这样的广告将无效）
    例如：
    - 你访问了百度，搜索了什么，百度通过 cookie 记录了你的搜索
    - 然后你访问京东，京东嵌入了对应百度广告的 js，那么就会在京东的域名下向百度（第三方网站）发起请求，携带百度的 cookie（第三方 cookie），拿到你刚百度搜索的东西
    - 京东根据你的搜索作自定义推荐
    - 所以，第三方 cookie 被限制（浏览器会限制）或是 cookie 被设置 sameSite 同源，第二步将无法进行。
13. 知道 csp 吗？（答了 csp 内容安全策略，随便说了几个作用，可以防止 xss 攻击，深入不了解）
14. 编程-实现一个 Mac 类用来储存和校验 mac 地址。考点：判断 16 进制，隐式转换

    ```js
    // 实现一个Mac类用来储存和校验mac地址，mac地址格式aa-bb-cc-dd-ee-ff,16进制数共12位，
    // 每两位中间有分隔符，满足以下使用方法:
    // const mac = new Mac('-'); // 初始化时传入分隔符

    // mac.set('11-22-33-44-55-66'); // 如果格式错误返回false
    // mac == '11-22-33-44-55-66'; // 返回true
    ```

15. 追问，能否用一个正则。（磕磕绊绊写出来了 `/^([0-9A-F][0-9A-F]-){5}([0-9A-F][0-9A-F]){1}$/i`）
16. 追问，正则如何改变分隔符，类似于上面的 class 传入一个分隔符。（用 new RegExp）
