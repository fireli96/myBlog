---
meta:
  - title: 实时记录一些小问题
    time: 2020-07-09 21:49:13
    tag: 总结
---

# 实时记录一些小问题

## 前言

开发过程中总是遇到一些小小问题，本文主要对这些小问题进行记录，以便后续进行详细阐述和留意。

<!-- more -->

## html

### label 两次点击事件

点击 label 也会触发相关联的 input 元素的 click 事件。

即如果是以下 2 种情况：

- 一个元素包含 label 和 input
- label 本身包括 input

那对这个元素和 label 监听点击事件，那当点击到 label 或其子元素时，会触发两次点击事件。

解决：

1. 在 input 上监听事件。
2. 判断事件源（`e.target.tagName==='INPUT'`)，只有 input 点击时才触发。

### focus 起作用

focus() 是需要元素在 input 在页面显示后才会起作用。
autofocus（ios Safari 浏览器不支持） 属性起作用是当元素第一次在页面显示(display 为非 none)，只会起一次作用。

### scale 缩小

`transform:scale()` 属性缩小某个元素时，如果其父元素的宽度如果依据于这个元素，那么父元素的宽度不会变小。

## vue

### 数组变化视图更新

vue 中数组的变异方法可以使得视图更新，替换数组也同样如此。

但当使用 `变异方法` + `替换` 的方式改变一个数组时，`替换` 不会生效（未全部证实）。

例如：`array.splice(0,1); array = [array[5]]`，后一句不会触发视图更新。

同时当数组的元素是对象时，对象属性的改变也不会触发视图更新，必须数组或元素直接改变。(需再证实)。

### event 属性

vue 事件中的 event 属性：

```javascript
// chorme浏览器
onClick() {
  console.log(event) //正确
}

// Firefox浏览器
onClick() {
  console.log(event) //错误
}

// 需要显式传入event
onClick(event) {
  console.log(event) //正确
}
```

### 同权重 css 优先级

全局样式 > 当前组件 > 子组件

### 静态资源引入

放入 `/src/assets` 文件下的图片：

1. 直接作为`img`的`src`的值、css 中引入，可以相对路径引入
2. 绑定`src`引入，需要`require`相对路径引入
3. 不能直接在`style`中的`background`中引入，需要绑定`style`并借助`require`相对路径引入

放在 `/public` 文件下的图片：

1. 直接引入`style="background:url(/back0.jpg)"`，绝对路径
2. 绑定引入`:style="{'background-image':'url(/back0.jpg)'}"`，不需要借助`require`

这是由于 `/src/assets` 下的图片打包后位置发生改变，以相对路径引入会被 webpack 处理（改变路径），但绝对路径引入不会，所以绝对路径引入并不能找到图片位置。

在 `/public` 文件下的图片不会被 webpack 处理，所以需要以绝对路径引入。相对路径引入会被 webpack 改变引入路径，就无法找到图片。

更多请见：[vue-cli 处理静态资源](https://cli.vuejs.org/zh/guide/html-and-static-assets.html#%E5%A4%84%E7%90%86%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90)。

### 快速绑定属性

1. `v-bind = "settings"`，settings 为一个 Object。
2. `v-bind = "{name}"`，`name: "li"`。

### 全局组件自动化注册

```javascript
// 自动化全局注册common目录下的组件
const requireComponent = require.context('./components/common', true, /\.vue$/)

requireComponent.keys().forEach((fileName) => {
  // 获取组件配置
  const componentConfig = requireComponent(fileName)
  // 剥路径`/xx`和文件类型`.xx`
  const componentName = fileName
    .split('/')
    .pop()
    .replace(/\.\w+$/, '')

  // 全局注册组件
  Vue.component(componentName, componentConfig.default || componentConfig)
})
```

参考:

[Vue 全局组件自动化注册](https://cn.vuejs.org/v2/guide/components-registration.html#基础组件的自动化全局注册)

### webpack 引入外部 js

不需要在每个 `.vue` 文件都去 `import`。

```javascript
plugins: [
  new webpack.ProvidePlugin({
    Velocity: 'velocity-animate'
  })
]
```

## css

### 自定义单选框

对于`radio`:

1. `name` 属性相同的 `radio` 表现为单选
2. 使用`label`标签包裹起来，那么点击`lable` 就相当于点击`radio`

```html demo
<label>
  <input type="radio" name="fruit" value="apple" />
  <span>苹果</span>
</label>
<label>
  <input type="radio" name="fruit" value="banana" />
  <span>香蕉</span>
</label>
<label>
  <input type="radio" name="fruit" value="pear" />
  <span>梨子</span>
</label>

<style>
  label {
    margin-right: 10px;
  }

  span {
    display: inline-block;
    background-color: rgb(245, 245, 245);
    padding: 8px;
    border-radius: 5px;
  }

  input[type='radio'] {
    width: 0;
  }

  input[type='radio']:checked + span {
    color: rgb(90, 141, 199);
    background: rgb(232, 243, 255);
  }
</style>
```

将 `radio` 的宽度设为 0 来隐藏 `radio`，`radio` 的 `checked` 伪类表示点击选中时触发。

`设定`span` 的默认样式，和选中后的样式。

### `\n` 可换行

```css
.container {
  white-space: pre-line;
  /* 保留多个空白符和换行 */
  white-space: pre;
}
```

或者使用 `pre` 标签

## js

### 输入框正整数

```js
value = parseInt(String(value).match(/^[0-9]*/)[0]) || ''
```
